# 3장 설계 전략 고안하기

- 위험 요소를 고려하면서 디자인 마인드셋을 선택하고 설계 전략을 확장해나가는 법을 알아보자

---

## 3.1 만족스럽게 설계하기

- 이상적으로는 문제를 온전히 정의한 후 이를 해결하는 완벽한 아키텍처를 설계할 수 있다. 현실은 그렇지 않다. 
- 이러한 현실적인 장벽을 `하버트 사이먼`은 `결박된 합리성(bounded rationality)` 이라고 칭하며 시간, 돈, 기술, 지식에서 발생한 이론적인 제약이 소프트웨어 아키텍처처럼 복잡한 문제를 합리적으로 설계하는 걸 어렵게 만든다고 한다. 
- 소프트웨어 아키텍처는 최적의 방법을 찾는 문제 풀이보다는 아래와 같은 활동을 장려해 만족스러운 설계를 찾아가는 과정

#### 실험으로 해결하기
- 생각해볼 수 있는 모든 해결책을 평가해야 할 실험이라고 생각해라
- 가설을 빠르고 저렴하게 평가할수록 이해관계자들이 만족할 만한 구조로 조합할 수 있고, 빠르게 이익을 실현할 수 있다. 

#### 위험 요소 줄이기
- 아키텍처 설계에 실패하면 모든 것이 실패한다.
- 어떤 부분이 잘못되고 있는지 늘 고심하며, 각 상황에 맞는 시나리오를 고려해야 한다. 

#### 문제 단순화화기
- 문제를 단순하게 하는 방법은 몇 가지가 있다.
- 참여하는 이해관계자 수를 줄이면 쟁점이 되는 사안도 그만큼 줄일 수 있다. 
- 복잡도를 낮추기 위해 제약을 추가, 삭제해 문제의 한 부분에만 초점을 맞춰볼 수도 있다. 
- 반복되는 문제를 파악하면 개선할 점을 찾기 쉽다. 
  - 반복되는 문제에는 대체로 해결책이 있으므로 찾아볼 수 있다.

#### 빠르게 반복하고 빠르게 배우기
- 짧고 촘촘한 일정으로 반복해서 경험하는 것이 모호한 목표만 바라보며 오랫동안 숙고하는 것보다 낫다.

#### 문제와 해결책을 동시에 생각하기
- 크리스토퍼 알렉산더는 `문제는 마음속에 둔 해결책으로 정의된다고 했습니다.` 
- 문제를 둘러싼 한계는 사실 문제를 해결할 수 있는 잠재적인 해결책으로 이루어져 있다.
- 설계 초기부터 코딩하는 방법도 문제와 해결책을 동시에 다루는 전략 중 하나이다.

---

## 3.2 설계를 얼마나 우선해야 하는가

- 시스템마다 요구사항과 규모에 맞는 `설계 최적점(design sweet spot)` 이 있다. 개발 전에 설계에 들일 최적의 시간을 의미한다.


### 3.2.1 설계의 최적점 찾기

- 배리 베임은 그의 논문에서 프로젝트 스케줄을 결정하는 가장 큰 요소는 개발 시간, 아키텍처 설계 계획, 재작업 이라고 했다. 
  - 재작업은 설계 결함을 수정하거나 코드를 재작성하거나 실수를 되돌리는 일 등을 의미한다. 
- 최적점은 규모가 얼마나 큰지, 요구사항이 얼마나 자주 변경되는지, 소프트웨어가 얼마나 복잡한지에 따라 크게 좌우됨
- 베임은 `설계에 시간을 쓸스록 재작업에 들어가는 시간이 줄어듬`을 표현하는 그래프를 표현
  - 설계 시간을 많이 확보하면 재작업은 줄어들고 전체 프로젝트 시간은 길어짐
  - 설계 시간을 줄이면 재작업이 늘고 전체 프로젝트 기간이 또다시 길어짐
- 최적점은 설계 비용과 재작업 사이의 어딘가에서 찾아야 한다. 
- 베임 그래프의 시사점
  - 시스템의 규모가 클수록 초기 설계에 투자하는 데서 얻는 이득이 커진다
  - 시스템의 규모가 작으면 초기 설계에 투자하는 데서 얻는 이득이 작아진다.
  - 아키텍처 설계에 거의 투자하지 않으면 큰 타격을 받을 수 있다. 
  - 아키텍처에 투자할수록 재작업이 줄어든다
- 설계에 얼마나 공을 들일지 판단할 때 복잡도도 고려한다. 
  - 복잡하다고 해서 무조건 큰 시스템은 아니다
  - 해결방법이 뻔하다면 시스템 규모가 커도 초기 설계는 아주 짧게 끝날 수 ㅇ있다. 

### 3.2.2 사례 연구: 전체 일정에 아키텍처가 미치는 영향 

> COSYSMO(Constructive Systems Engineering Model)은 베임의 연구 결과를 반영하고 있다. 
> COSYSMO와 COCOMO 2.0 툴을 프로젝트 데이터에 적용해보길 추천한다. 

---

## 3.3 위험 요소를 가이드로 삼기

- 만들 가치가 있는 소프트웨어는 항상 위험도 따른다. 
- 불확실한 요소도 없고 의문도 없는 소프트웨어라면 애초에 아키텍처가 필요하지도 않다.
> - 걱정되는 사항을 모두 나열하고 심각한 문제를 초래하는 순서대로 정렬한다. 
> - 상위의 위험 요소 하나를 선택하고 이를 해소할 수 있는 디자인 마인드셋을 고른다 

### 3.3.1 조건과 결과 알아내기
  
- `위험(risk)`은 미래에 일어날 수도 있는 나쁜 일에 대한 암시이다. 나쁜 일이 실제로 일어나면 그때는 `문제`라 말한다
- `만약에`는 설계하는데 아무런 도움이 되지 않는다. 추측하기보다는 현재의 아키텍처를 파악하고 다음에 어떻게 설계할지에 대해 논의하라
- 위험은 두 두분으로 나뉜다
  - 조건(condition) : 현재의 사실을 의미.
  - 결과(consequence) : 무언가 잘못되었을 때 조건과 직접적으로 결부된 사항을 의미.
- 조건 - 결과 템플릿에 따라 기록한 위험 구문 예시
```
조건(현재의 사실) - 사무실 맞은편에 부리토 음식점이 생겼다
결과(아마도 일어날 수 있는 나쁜일) - 동료가 부리토를 너무 많이 먹으면 복통을 앓을 수 있다. 
```
- 이런 위험을 줄이는 방법은 아래와 같다.
  - 확률 낮추기 : 며칠에 한 번마다 음식 배달을 하고 한 사람이 먹을 수 있는 최대 섭취량을 안내한다.
  - 영향 낮추기 : 사무실에 소화제를 비치한다.
  - 위험이 발생할 시간 없애기 : 점심 시간에 미팅을 만들어서 저녁에만 부리토를 먹도록 한다. 
  - 조건 없애기 : 사무실을 이사한다. 또는 근무시간을 변경해 전 직원이 음식점이 닫은 밤에 일하도록 한다.
  - 있는 그대로 받아들이고 아무것도 하지 않기 : 가끔 사람들이 부리토를 너무 많이 먹을 수도 있지만 그 문제가 실제로 일어나면 대처한다. 

- 위험의 조건과 결과를 제대로 알면 어떤 대처를 해야 할지 선택지를 만들 수 있다. 

    |위험구문|왜 위험한가|
    |--------|--------|
    |새 부리토 음식점이 생겼다.|그래서 어쩌란 말인가? 부정적인 영향이 불명확하다. 솔찍히 좋은 소식이다. 우리는 부리토를 좋아한다.|
    |팀원들이 부리토를 너무 좋아한다.|그리 좋아 보이지 않는다. 하지만 딱히 걱정할 필요는 없다.|
    |부리토를 너무 많이 먹으면 배탈이 난다.|사실이다. 하지만 우리 팀이 겪고 있는 문제는 아니다.|
    |팀원이 부리토를 너무 많이 먹으면 배탈이 날 것이다|부리토를 왜 그렇게 걱정하는가?|

### 3.3.2 위험을 활용해 적절한 디자인 마인드셋 선택하기 

| 적용할 디자인 마인드셋 | 만약에... |
|----------------------|-----------|
| 이해하기 | 문제 정의가 위험 요소인 경우. 이해관계자나 연관된 시스템에 대해 더 깊게 이해할 필요가 있나요? |
| 탐색하기 | 해결 방법이 위험 요소인 경우. 다른 대안은 없나요? |
| 실현하기 | 커뮤니케이션이 위험 요소인 경우. 이해관계자들이 설계를 충분히 이해했고 설계도를 볼 수 있나요? |
| 평가하기 | 설계의 의사결정이나 설계의 전반적인 적합성이 위험 요소인 경우. 설계에 대한 의사결정을 해야 하나요? |

### 3.3.3 위험이 줄면 수동적인 설계로 전환한다.

- 조지 페어뱅크스는 `아키텍트는 아키텍처가 시스템에서 위험 요소가 아닐 때까지 기술적 위험을 줄여야 한다` 고 말함
- 아키텍처가 더는 시스템에서 가장 큰 위험 요소가 아니라면, `능동적인 설계`에서 `수동적인 설계`로 전환하라.
  - 능동적인 설계 : 위험을 줄이기 위한 설계 프로세스
  - 수동적인 설계 : 시스템에 구현된 아키텍처를 관찰하고 필요에 따라 수정 조치를 취함. 
- 아키텍처가 다시 위험을 품게 되면, 능동적인 설계로 다시 전환하고 새로운 현실을 반영해 아키텍처를 조정해야 한다. 

----

## 3.4 설계 계획 세우기

- 설계 계획을 공식적인 일정으로 삼을 필요는 없지만, 몇 가지 개념은 가지고 있어야 한다. 

  - 설계의 판단 근거
    - 정답은 없다. 판단 근거는 팀, 이해관계짜, 프로젝트 맥락에 따라 달라진다.
  - 디자인 산출물
    - 설계를 시작하기 전에 아키텍처의 문서화 계획을 알린다(러프하게, 전통적인 문서?, 특정 템플릿 사용?, 저장위치 등)
  - 일정
    - 프로젝트 일정 내에서 주요 설계 마일스톤을 정한다. 
  - 위험요소
    - 주요 위험 요소를 설계 계획에서 다룬다. 특히 선행 아키텍처 설계 중에 위험 목록을 검토한다.
  - 개괄적인 아키텍처 디자인
    - 어림짐작한 해결법을 먼저 구상한다. 
    - 문제를 정의하기 위한 해결법이어야 한다.
    - 초기에 구상한 대략적인 설계



